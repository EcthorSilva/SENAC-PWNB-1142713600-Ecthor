<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Cadastro de Cliente</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    </head>
    <body>
        <section class="vh-100" style="background-color: #efefef;">
            <div class="container py-5">
                <div class="row d-flex justify-content-center">
                    <div class="col-md-5">
                        <div class="card mb-4">
                            <div class="card-header py-3">
                                <h5 class="mb-0 text-center">Cadastro de Clientes</h5>
                            </div>
                            <div class="card-body p-4">
                                <form>
                                    <!-- Nome e Sobrenome -->
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="nome" class="form-label">Nome</label>
                                            <input type="text" class="form-control" id="nome">
                                        </div>
                                        <div class="col">
                                            <label for="sobrenome" class="form-label">Sobrenome</label>
                                            <input type="text" class="form-control" id="sobrenome">
                                        </div>
                                    </div>
                                    <!-- data de nascimento -->
                                    <div class="row mb-3">
                                        <div class="col-5">
                                            <label for="dataNascimento" class="form-label">Data de Nascimento</label>
                                            <input type="text" class="form-control" id="dataNascimento" placeholder="dd/mm/aaaa">
                                        </div>

                                        <div class="col">
                                            <label for="tipoCliente" class="form-label">Tipo de Cliente</label>
                                            <select class="form-select" id="tipoCliente">
                                                <option selected>Escolha uma opção</option>
                                                <option value="bronze">Bronze</option>
                                                <option value="prata">Prata</option>
                                                <option value="ouro">Ouro</option>
                                                <option value="platina">Platina</option>
                                                <option value="diamante">Diamante</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!-- endereço e numero -->
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="endereco" class="form-label">Endereço</label>
                                            <input type="text" class="form-control" id="endereco">
                                        </div>
                                        <div class="col-3">
                                            <label for="numero" class="form-label">Número</label>
                                            <input type="text" class="form-control" id="numero">
                                        </div>
                                    </div>

                                    <div class="row mb-3">
                                        <div class="col-5">
                                            <label for="cep" class="form-label">CEP</label>
                                            <input type="text" class="form-control" id="cep" placeholder="12345-000">
                                        </div>
                                        <div class="col">
                                            <label for="cidade" class="form-label">Cidade</label>
                                            <input type="text" class="form-control" id="cidade">
                                        </div>
                                    </div>
                                    <!-- Botões -->
                                    <div class="row">
                                        <div class="col d-flex justify-content-center">
                                            <button type="submit" class="btn btn-primary mx-2">Cadastrar</button>
                                            <button type="" class="btn btn-primary mx-2">Excluir</button>
                                            <button type="button" id="limparBtn" class="btn btn-primary mx-2">Limpar</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="alert alert-danger d-flex justify-content-center visually-hidden" role="alert">
                            <strong></strong>
                        </div>
                    </div>
                    <!-- tabela -->
                    <div class="col-md-7">
                        <div class="card mb-4">
                            <div class="card-header py-3">
                                <h5 class="mb-0">Status</h5>
                            </div>
                            <div class="card-body">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Nome</th>
                                            <th>Nascimento</th>
                                            <th>Endereço</th>
                                            <th>UF</th>
                                            <th>Ação</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Ecthor</td>
                                            <td>26/09/1997</td>
                                            <td>Avenida Rosália Iannini Conde, 441</td>
                                            <td>São Paulo</td>
                                            <td>
                                                <button class="btn btn-primary"><i class="bi bi-pencil"></i></button>
                                                <button class="btn btn-danger"><i class="bi bi-trash"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const form = document.querySelector('form');
                const tableBody = document.querySelector('tbody');
                const alertDiv = document.querySelector('.alert');

                form.addEventListener('submit', function (event) {
                    event.preventDefault();
                    let errorMessage = '';

                    // Obter os valores dos campos do formulário
                    const nome = document.getElementById('nome').value;
                    const dataNascimento = document.getElementById('dataNascimento').value;
                    const endereco = document.getElementById('endereco').value;
                    const numero = document.getElementById('numero').value;
                    const cep = document.getElementById('cep').value;
                    const cidade = document.getElementById('cidade').value;

                    // Validar os campos com regex (exemplo: validar data de nascimento)
                    const dataNascimentoRegex = /^\d{2}\/\d{2}\/\d{4}$/;
                    const cepRegex = /^\d{5}-\d{3}$/;

                    // Adicionar mais validações conforme necessário
                    if (!dataNascimentoRegex.test(dataNascimento)) {
                        errorMessage = 'Data de nascimento inválida. Use o formato dd/mm/aaaa.';
                        document.getElementById('dataNascimento').addEventListener('focus', function () {
                            alertDiv.classList.add('visually-hidden');
                        });
                    } else if (!cepRegex.test(cep)) {
                        errorMessage = 'CEP inválido. Use o formato 12345-000.';
                        document.getElementById('cep').addEventListener('focus', function () {
                            alertDiv.classList.add('visually-hidden');
                        });
                    }

                    // Se houver mensagem de erro, exibi-la no alerta
                    if (errorMessage) {
                        alertDiv.classList.remove('visually-hidden');
                        alertDiv.textContent = errorMessage;

                        // Ocultar a mensagem de erro após 5 segundos
                        setTimeout(function () {
                            alertDiv.classList.add('visually-hidden');
                        }, 5000);

                        return;
                    }

                    // Criar uma nova linha na tabela com os dados do cliente
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                    <td>${nome}</td>
                    <td>${dataNascimento}</td>
                    <td>${endereco}, ${numero}</td>
                    <td>${cidade}</td>
                    <td>
                        <button class="btn btn-primary"><i class="bi bi-pencil"></i></button>
                        <button class="btn btn-danger"><i class="bi bi-trash"></i></button>
                    </td>`;

                    // Adicionar a nova linha à tabela
                    tableBody.appendChild(newRow);

                    // Limpar os campos do formulário após adicionar o cliente
                    form.reset();
                });

                // Chamada de API para buscar endereço pelo CEP usando fetch
                document.getElementById('cep').addEventListener('input', function () {
                    const cep = this.value.replace(/\D/g, ''); // Remove caracteres não numéricos do CEP
                    if (cep.length === 8) {
                        fetch(`https://viacep.com.br/ws/${cep}/json/`)
                            .then(response => response.json())
                            .then(data => {
                                if (!data.erro) {
                                    document.getElementById('endereco').value = data.logradouro;
                                    document.getElementById('cidade').value = data.localidade;
                                    // Você também pode preencher outros campos, como estado, com os dados da API
                                } else {
                                    alertDiv.classList.remove('visually-hidden');
                                    alertDiv.textContent = 'CEP não encontrado';

                                    // Ocultar a mensagem de erro após 5 segundos
                                    setTimeout(function () {
                                        alertDiv.classList.add('visually-hidden');
                                    }, 5000);
                                }
                            })
                            .catch(error => console.error(error));
                    }
                });

                // Limpar todos os inputs
                const limparBtn = document.getElementById('limparBtn');
                const limparInputs = () => {
                    document.getElementById('nome').value = '';
                    document.getElementById('sobrenome').value = '';
                    document.getElementById('dataNascimento').value = '';
                    document.getElementById('tipoCliente').selectedIndex = 0; // Define a opção padrão
                    document.getElementById('endereco').value = '';
                    document.getElementById('numero').value = '';
                    document.getElementById('cep').value = '';
                    document.getElementById('cidade').value = '';
                };
                limparBtn.addEventListener('click', () => {
                    limparInputs();
                });
            });
        </script>
    </body>
</html>